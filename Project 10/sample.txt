// Mode 0

input:
0 5 1 4
0 1 1
0 2 1
2 3 1
2 4 1
3 4 1
x

output:
0

// Mode 1

input:
1 5 0 4
0 1 1
0 2 1
2 3 1
2 4 1
3 4 1
x

output:
1

// Mode 2

input:
2 5 2 0
0 1 1
0 2 1
2 3 1
2 4 1
3 4 1
x

output:
3

// Mode 3

input:
3 5 0 0
0 1 1
0 2 1
2 3 1
2 4 1
3 4 1
x

output:
01234

// Mode 4

input:
4 5 0 0
0 1 1
0 2 1
2 3 1
2 4 1
3 4 1
x

output:
01234

// Mode 5

input:
5 5 0 4
0 1 1
0 2 2
2 3 4
2 4 5
3 4 6
x

output:
3
7
024